{% extends 'baseBack.html.twig' %}

{% block title %}<title>Appointment index</title>{% endblock %}
{% block body %}
<style>

.pagination {
    display: flex;
    justify-content: center; /* Centrer les éléments horizontalement */
}

.pagination-button {
    background-color: #dbdfe4;
    color: #fff;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 5px; /* Ajoute une marge horizontale entre les boutons */
    width: 100px; /* Spécifie une largeur fixe pour tous les boutons */
}

.pagination-button.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
.pagination-button {
    background-color: #ff0000; /* Couleur de fond rouge pour les boutons de pagination */
    color: #fff; /* Couleur du texte en blanc */
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 5px; /* Ajoute une marge horizontale entre les boutons */
    transition: background-color 0.3s ease; /* Ajoute une transition fluide pour le changement de couleur de fond */
}

.pagination-button:hover {
    background-color: #CD181F; /* Couleur de fond rouge légèrement plus foncée au survol */
}

.create-new-button {
    background-color: #ff0000; /* Couleur de fond rouge pour le bouton "Create new" */
    color: #fff; /* Couleur du texte en blanc */
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease; /* Ajoute une transition fluide pour le changement de couleur de fond */
}

.create-new-button:hover {
    background-color: #cc0000; /* Couleur de fond rouge légèrement plus foncée au survol */
}
 .filter-form {
        margin-bottom: 20px; /* Ajoute une marge en bas du formulaire */
    }

    .filter-form label {
        margin-right: 10px; /* Ajoute une marge à droite des étiquettes */
    }

    .filter-input {
        padding: 8px;
        border: 1px solid #ccc; /* Ajoute une bordure autour du champ de filtrage */
        border-radius: 4px;
        margin-right: 10px; /* Ajoute une marge à droite du champ de filtrage */
    }

    .filter-button {
        background-color: #ff0000; /* Couleur de fond rouge pour le bouton de filtrage */
        color: #fff; /* Couleur du texte en blanc */
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease; /* Ajoute une transition fluide pour le changement de couleur de fond */
    }

    .filter-button:hover {
        background-color: #cc0000; /* Couleur de fond rouge légèrement plus foncée au survol */
    }
/* Style pour le conteneur principal */
.container {
    margin-top: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background-color: #f9f9f9;
}


</style>
<div class="container mt-4">
    <h1 class="mb-4">Appointment index</h1>
    <table class="table table-borderless table-data3">
        <thead class="thead-dark">
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Appointment date</th>
                <th scope="col">Hour </th>
                <th scope="col">location</th>
                <th scope="col">candidate email</th>
                <th scope="col">Email Company Representative</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
        <form action="{{ path('app_rendezvous_index') }}" method="get" class="filter-form">
    <label for="lieu">Lieu:</label>
    <input type="text" id="lieu" name="lieu" class="filter-input">
    <label for="emailRepresen">Email Company Representative:</label>
    <input type="text" id="emailRepresen" name="emailRepresen" class="filter-input">
    <input type="submit" value="Filter" class="filter-button">
</form>

            {% for rendezvou in rendezvouses %}
                <tr>
                    <td>{{ rendezvou.id }}</td>
                    <td>{{ rendezvou.dateRendez ? rendezvou.dateRendez|date('Y-m-d') : '' }}</td>
                    <td>{{ rendezvou.heureRendez }}</td>
                    <td>{{ rendezvou.lieu }}</td>
                    <td>{{ rendezvou.emailCondi }}</td>
                    <td>{{ rendezvou.emailRepresen }}</td>
                    <td>
                        <a href="{{ path('app_rendezvous_show', {'id': rendezvou.id}) }}" class="btn btn-danger btn-sm">Show</a>

                        <a href="{{ path('app_rendezvous_edit', {'id': rendezvou.id}) }}" class="btn btn-danger btn-sm">Edit</a>
                        <form action="{{ path('app_rendezvous_delete', {'id': rendezvou.id}) }}" method="post" style="display: inline-block;">
                            <input type="hidden" name="_method" value="DELETE">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ rendezvou.id) }}">
                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this item?')">Delete</button>
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="7">No records found</td>
                </tr>
            {% endfor %}
        

        </tbody>
    </table>
    <div class="text-center">
    <a href="{{ path('app_rendezvous_new') }}" class="btn btn-primary create-new-button" style="margin-bottom: 20px;">Create new</a>
</div>
 <div class="navigation">
            <ul class="pagination">
                <li class="page-item">
                    {% if rendezvouses.currentPageNumber > 1 %}
                        <a href="{{ path('app_rendezvous_index', {'page': rendezvouses.currentPageNumber - 1}) }}" class="page-link pagination-button">Previous</a>
                    {% else %}
                        <span class="page-link pagination-button disabled">Previous</span>
                    {% endif %}
                </li>
                <li class="page-item">
                    {% if rendezvouses.currentPageNumber < rendezvouses.pageCount %}
                        <a href="{{ path('app_rendezvous_index', {'page': rendezvouses.currentPageNumber + 1}) }}" class="page-link pagination-button">Next</a>
                    {% else %}
                        <span class="page-link pagination-button disabled">Next</span>
                    {% endif %}
                </li>
            </ul>
        </div>
       </style>


    <div class="navigation">
        <ul class="pagination">
            <!-- Votre pagination -->
        </ul>
    </div>

    <div class="container mt-4">
        <h2>Statistics by hour</h2>
        <canvas id="hourlyStatisticsChart" width="10" height="10"></canvas>


    </div>

</div>

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var hourLabels = [];
            var appointmentCounts = [];

            {% for hour, count in appointmentsByHour %}
                hourLabels.push('{{ hour }}');
                appointmentCounts.push('{{ count }}');
            {% endfor %}

            var ctx = document.getElementById('hourlyStatisticsChart').getContext('2d');
            var hourlyStatisticsChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: hourLabels,
                    datasets: [{
                        label: 'Number of appointments',
                        data: appointmentCounts,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    legend: {
                        position: 'right'
                    }
                }
                
            });
        });
    </script>
    {% endblock %}
{% endblock %}
